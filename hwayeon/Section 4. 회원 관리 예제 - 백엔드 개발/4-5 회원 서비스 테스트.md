# 4-5 íšŒì› ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

## MemberServiceTest í´ë˜ìŠ¤ ë§Œë“¤ê¸°

- test/java/hello.hello-spring/service/MemberServiceTest

```java
package hello.hello_spring.service;

import hello.hello_spring.domain.Member;
import hello.hello_spring.repository.MemoryMemberRepository;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.AssertionsForClassTypes.assertThat;
import static org.junit.jupiter.api.Assertions.*;

class MemberServiceTest {

    // MemberServiceë¥¼ ìƒì„±í•  ë•Œ MemoryMemberRepositoryë¥¼ ì§ì ‘ ë„£ì–´ì¤Œ, ì™¸ë¶€ì—ì„œ ìƒì„±
    // ê°™ì€ memberRepository ì‚¬ìš©
    MemberService memberService;
    MemoryMemberRepository memberRepository;

    // ì‹¤í–‰ ì „ì— í˜¸ì¶œ, í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ê°ê° ìƒì„±
    @BeforeEach
    public void beforeEach() {
        memberRepository = new MemoryMemberRepository();
        memberService = new MemberService(memberRepository);
    }

    @AfterEach
    public void afterEach() {
        memberRepository.clearStore();
    }

    @Test
    void íšŒì›ê°€ì…() {
        // given
        Member member = new Member();
        member.setName("hello");

        // when
        Long saveId = memberService.join(member);

        // then
        Member findMember = memberService.findOne(saveId).get();
        assertThat(member.getName()).isEqualTo(findMember.getName());
    }

    @Test
    public void ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸() {
        // given
        Member member1 = new Member();
        member1.setName("spring");

        Member member2 = new Member();
        member2.setName("spring");

        // when
        memberService.join(member1);
        // try-catch ë„£ê¸° ì• ë§¤ -> ë¬¸ë²• ì œê³µ
        IllegalStateException e = assertThrows(IllegalStateException.class, () -> memberService.join(member2));// ì˜ˆì™¸ í„°ì ¸ì•¼í•¨

        assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        
        /* try-catchë¬¸
        try {
            memberService.join(member2);
            fail();
        } catch(IllegalStateException e) {
            assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        }
        */
    }
}

```

- @BeforeEach : ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ì— í˜¸ì¶œ. í…ŒìŠ¤íŠ¸ê°€ ì„œë¡œ ì˜í–¥ì´ ì—†ë„ë¡ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ë„ ìƒˆë¡œ ë§ºì–´ì¤€ë‹¤.

### MemberService  ê¸°ì¡´ ì½”ë“œ

```java
class MemberServiceTest {
    MemberService memberService = new MemberService();
    MemoryMemberRepository memberRepository = new MemoryMemberRepository();
 }
```

```java
public class MemberService {
    private final MemberRepository memberRepository = new MemoryMemberRepository();
}
    
```

- MemberServiceì—ì„œ ë§Œë“  MemoryMemberRepositoryì™€ MemberServiceTestì—ì„œ ë§Œë“  MemoryMemberRepositoryëŠ” newë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ repositoryê°€ ë¨, ë‹¤ë¥¸ interfaceë¥¼ ì‚¬ìš©

### MemberService ìˆ˜ì •ëœ ì½”ë“œ

- íšŒì› ì„œë¹„ìŠ¤ ì½”ë“œë¥¼ DI(Dependency Injection) ê°€ëŠ¥í•˜ê²Œ ë³€ê²½

```java
public class MemberService {

    private final MemberRepository memberRepository;

    // memberRepositoryë¥¼ ì§ì ‘ ìƒì„±í•˜ëŠ”(new) ê²ƒì´ ì•„ë‹Œ ì™¸ë¶€ì—ì„œ(test) ìƒì„±
    // -> DI(Dependency Injection)
    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
    ...
 }
```

### given - when - then

- given : ì–´ë– í•œ ë°ì´í„°ê°€ ì£¼ì–´ì§
- when : ì–´ë– í•œ ê²ƒì„ ì‹¤í–‰ í–ˆì„ ë•Œ(ê²€ì¦í•´ì•¼ í•  ê²ƒ)
- then : íŠ¹ì • ê²°ê³¼ê°€ ë‚˜ì™€ì•¼ í•¨(ê²€ì¦ë¶€)

<aside>
ğŸ’¡

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìƒì„± ë‹¨ì¶•í‚¤ - Ctrl + Shift + T

class name : MemberServiceTest, ë©¤ë²„ ì„ íƒ

</aside>